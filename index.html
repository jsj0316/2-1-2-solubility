<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ìš©í•´ë„ ê°€ìƒ ì‹¤í—˜ì‹¤</title>
    
    <!-- í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- í™”ë©´ ìº¡ì²˜ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
      @keyframes spin-slow {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }
      .animate-spin-slow {
        animation: spin-slow 3s linear infinite;
      }
      /* ë„˜ë²„ ì¸í’‹ í™”ì‚´í‘œ ìˆ¨ê¸°ê¸° */
      input[type=number]::-webkit-inner-spin-button, 
      input[type=number]::-webkit-outer-spin-button { 
        -webkit-appearance: none; 
        margin: 0; 
      }
      input[type=number] {
        -moz-appearance: textfield;
      }
      /* ë””ì§€í„¸ í°íŠ¸ ëŠë‚Œ */
      @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
      .font-digital {
        font-family: 'Share Tech Mono', monospace;
      }
    </style>
  </head>
  <body class="bg-gray-50 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useEffect } = React;

      // --- ì•„ì´ì½˜ ì»´í¬ë„ŒíŠ¸ ---
      const IconBase = ({ size = 24, className = "", children }) => (
        <svg 
          xmlns="http://www.w3.org/2000/svg" 
          width={size} height={size} viewBox="0 0 24 24" fill="none" 
          stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" 
          className={className}
        >
          {children}
        </svg>
      );

      const Beaker = (props) => (
        <IconBase {...props}><path d="M4.5 3h15" /><path d="M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3" /><path d="M6 14h12" /></IconBase>
      );
      const Thermometer = (props) => (
        <IconBase {...props}><path d="M14 14.76V3.5a2.5 2.5 0 0 0-5 0v11.26a4.5 4.5 0 1 0 5 0z" /></IconBase>
      );
      const Flame = (props) => (
        <IconBase {...props}><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.1.2-2.2.5-3.3.3-1.09.8-2.1 1.5-3.2.5 1.1 1 2.2 1.5 3.3.5 1.1 1 2.2 1.5 3.3z" /></IconBase>
      );
      const Snowflake = (props) => (
        <IconBase {...props}><line x1="2" x2="22" y1="12" y2="12" /><line x1="12" x2="12" y1="2" y2="22" /><path d="m20 16-4-4 4-4" /><path d="m4 8 4 4-4 4" /><path d="m16 4-4 4-4-4" /><path d="m8 20 4-4 4 4" /></IconBase>
      );
      const RefreshCw = (props) => (
        <IconBase {...props}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" /><path d="M21 3v5h-5" /><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" /><path d="M8 16H3v5" /></IconBase>
      );
      const CheckCircle = (props) => (
        <IconBase {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" /><polyline points="22 4 12 14.01 9 11.01" /></IconBase>
      );
      const AlertCircle = (props) => (
        <IconBase {...props}><circle cx="12" cy="12" r="10" /><line x1="12" x2="12" y1="8" y2="12" /><line x1="12" x2="12.01" y1="16" y2="16" /></IconBase>
      );
      const Scale = (props) => (
        <IconBase {...props}><path d="m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z"/><path d="M7 21h10"/><path d="M12 3v18"/><path d="M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2"/></IconBase>
      );
      const Trophy = (props) => (
        <IconBase {...props}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6" /><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18" /><path d="M4 22h16" /><path d="M10 14.66V17" /><path d="M14 14.66V17" /><path d="M18 2a2 2 0 0 1 2 2v2a6 6 0 0 1-5 5.5l-3 1.5-3-1.5A6 6 0 0 1 4 6V4a2 2 0 0 1 2-2z" /><path d="M10 22v-5" /><path d="M14 22v-5" /></IconBase>
      );
      const Camera = (props) => (
        <IconBase {...props}><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></IconBase>
      );

      const App = () => {
        // --- ìƒíƒœ ê´€ë¦¬ ---
        const [temp, setTemp] = useState(20);
        const [massA] = useState(60); 
        const [massB] = useState(10); 
        
        const [simState, setSimState] = useState('setup'); // setup, heating, cooling, challenge
        const [challengeMessage, setChallengeMessage] = useState(null);
        const [essayText, setEssayText] = useState("");

        // --- ë¬¼ë¦¬ ìƒìˆ˜ ë° ê³„ì‚° ë¡œì§ ---
        const getSolubilityA = (t) => Math.round(10 + 0.012 * t * t + 0.4 * t);
        const getSolubilityB = (t) => Math.round(5 + 0.4 * t);

        const solA = getSolubilityA(temp);
        const solB = getSolubilityB(temp);

        const precipitatedA = Math.max(0, massA - solA);
        const precipitatedB = Math.max(0, massB - solB);
        
        const totalPrecipitate = precipitatedA + precipitatedB;

        // --- í•¸ë“¤ëŸ¬ ---
        const handleTempSlider = (e) => {
          setTemp(Number(e.target.value));
          setChallengeMessage(null);
        };

        const handleTempInput = (e) => {
          let val = parseInt(e.target.value, 10);
          if (isNaN(val)) val = 0;
          if (val < 0) val = 0;
          if (val > 80) val = 80;
          setTemp(val);
          setChallengeMessage(null);
        };
        
        const startExperiment = () => {
          setSimState('heating');
          setTemp(20);
          setChallengeMessage(null);
          setEssayText("");
        };

        const heatUp = () => {
          let t = temp;
          const interval = setInterval(() => {
            t += 2;
            if (t >= 80) {
              t = 80;
              clearInterval(interval);
              setSimState('cooling');
            }
            setTemp(t);
          }, 50);
        };

        const checkOptimalTemp = () => {
          if (precipitatedB > 0) {
            setChallengeMessage({
              type: 'fail',
              text: 'ì‹¤íŒ¨! ë¬¼ì§ˆ B(ë¶ˆìˆœë¬¼)ê°€ í•¨ê»˜ ì„ì¶œë˜ì—ˆìŠµë‹ˆë‹¤. ì˜¨ë„ë¥¼ ì¡°ê¸ˆ ë” ë†’ì—¬ì•¼ í•©ë‹ˆë‹¤.'
            });
          } else if (precipitatedA === 0) {
            setChallengeMessage({
              type: 'fail',
              text: 'ì•„ì§ ì•„ë¬´ê²ƒë„ ì„ì¶œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì˜¨ë„ë¥¼ ë‚®ì¶°ë³´ì„¸ìš”.'
            });
          } else {
            const solB_next = getSolubilityB(temp - 1);
            if (10 > solB_next) {
              setChallengeMessage({
                type: 'success',
                text: `ì„±ê³µ! ìˆœìˆ˜í•œ ë¬¼ì§ˆ Aë¥¼ ìµœëŒ€ë¡œ ì–»ì„ ìˆ˜ ìˆëŠ” ìµœì ì˜ ì˜¨ë„ì…ë‹ˆë‹¤. (A: ${precipitatedA}g íšë“)`
              });
            } else if (10 > getSolubilityB(temp - 3)) {
              setChallengeMessage({
                type: 'warning',
                text: 'ìˆœìˆ˜í•œ Aë§Œ ë‚˜ì™”ì§€ë§Œ, ì˜¨ë„ë¥¼ ì¡°ê¸ˆ ë” ë‚®ì¶”ë©´ Aë¥¼ ë” ë§ì´ ì–»ì„ ìˆ˜ ìˆì„ ê²ƒ ê°™ì•„ìš”!'
              });
            } else {
              setChallengeMessage({
                type: 'warning',
                text: 'ìˆœìˆ˜í•œ Aë§Œ ë‚˜ì™”ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì˜¨ë„ë¥¼ ë” ë‚®ì¶”ë©´ ìˆ˜ë“ëŸ‰ì„ ëŠ˜ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
              });
            }
          }
        };

        const reset = () => {
          setTemp(20);
          setSimState('setup');
          setChallengeMessage(null);
          setEssayText("");
        };

        const handleCapture = async () => {
          const element = document.getElementById('capture-area');
          if (!element) return;
          try {
            await new Promise(resolve => setTimeout(resolve, 100));
            const canvas = await html2canvas(element, { 
              scale: 2,
              backgroundColor: "#f9fafb" 
            });
            const image = canvas.toDataURL("image/png");
            const link = document.createElement('a');
            link.href = image;
            link.download = 'ë¶„ë³„ê²°ì •ì‹¤í—˜_ë³´ê³ ì„œ.png';
            link.click();
          } catch (err) {
            console.error("Capture failed", err);
            alert("í™”ë©´ ìº¡ì²˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
          }
        };

        // --- ë Œë”ë§ í—¬í¼: ë¹„ì»¤ & ë””ì§€í„¸ ì˜¨ë„ê³„ ---
        const renderBeaker = () => {
          const solidHeight = Math.min(80, totalPrecipitate * 1.5);
          return (
            <div className="relative w-48 h-64 mx-auto mt-8">
              {/* ë””ì§€í„¸ ì˜¨ë„ê³„ */}
              <div className="absolute right-2 -top-12 flex flex-col items-center z-20">
                <div className="bg-gray-800 text-green-400 font-digital text-lg px-3 py-1.5 rounded-md shadow-lg border-2 border-gray-600 flex items-center justify-center min-w-[70px]">
                  {temp.toFixed(1)}<span className="text-xs ml-1">Â°C</span>
                </div>
                <div className="w-2 h-44 bg-gradient-to-r from-gray-300 to-gray-400 border-x border-gray-500 rounded-b-full shadow-inner z-10"></div>
              </div>

              {/* ë¹„ì»¤ ë³¸ì²´ */}
              <div className="absolute bottom-0 w-full h-56 border-x-4 border-b-4 border-gray-300 rounded-b-xl bg-blue-50 bg-opacity-30 overflow-hidden backdrop-blur-sm shadow-xl z-0">
                <div className="absolute bottom-0 w-full h-48 bg-blue-200 bg-opacity-40 transition-all duration-500"></div>
                {totalPrecipitate > 0 && (
                  <div 
                    className={`absolute bottom-0 w-full opacity-90 transition-all duration-500 flex items-end justify-center border-t ${precipitatedB > 0 ? 'bg-purple-100' : 'bg-white'}`}
                    style={{ 
                      height: `${solidHeight}px`, 
                      clipPath: 'polygon(0% 100%, 5% 90%, 15% 95%, 25% 85%, 35% 95%, 45% 90%, 55% 95%, 65% 85%, 75% 95%, 85% 90%, 95% 95%, 100% 100%)' 
                    }}
                  >
                    <div className="text-[10px] text-gray-500 mb-2 font-bold bg-white bg-opacity-70 px-1 rounded">
                      {precipitatedB > 0 ? 'í˜¼í•©ëœ ê³ ì²´' : 'ìˆœìˆ˜í•œ A'}
                    </div>
                  </div>
                )}
                {temp > 80 && <div className="absolute inset-0 bg-red-500 mix-blend-overlay opacity-20 animate-pulse"></div>}
              </div>
              
              {/* ê°€ì—´/ëƒ‰ê° íš¨ê³¼ ì•„ì´ì½˜ */}
              <div className="absolute -bottom-10 left-1/2 transform -translate-x-1/2">
                  {simState === 'heating' && <Flame className="text-orange-500 animate-bounce" size={36} />}
                  {simState === 'cooling' && <Snowflake className="text-blue-400 animate-spin-slow" size={36} />}
                  {simState === 'challenge' && <Trophy className="text-yellow-500 animate-bounce" size={36} />}
              </div>
            </div>
          );
        };

        // --- ë Œë”ë§ í—¬í¼: ê·¸ë˜í”„ ---
        const renderGraph = () => {
          const width = 300;
          const height = 200;
          const padding = 30;
          const graphWidth = width - padding * 2;
          const graphHeight = height - padding * 2;

          const maxTemp = 80;
          const maxSol = 120; 

          const getX = (t) => padding + (t / maxTemp) * graphWidth;
          const getY = (s) => height - padding - (s / maxSol) * graphHeight;

          let pathA = `M ${getX(0)} ${getY(getSolubilityA(0))}`;
          let pathB = `M ${getX(0)} ${getY(getSolubilityB(0))}`;

          for (let t = 1; t <= maxTemp; t++) {
            pathA += ` L ${getX(t)} ${getY(getSolubilityA(t))}`;
            pathB += ` L ${getX(t)} ${getY(getSolubilityB(t))}`;
          }

          return (
            <svg width={width} height={height} className="bg-white border border-gray-200 rounded-md">
              <line x1={padding} y1={height - padding} x2={width - padding + 10} y2={height - padding} stroke="#cbd5e1" strokeWidth="2" />
              <line x1={padding} y1={padding - 10} x2={padding} y2={height - padding} stroke="#cbd5e1" strokeWidth="2" />

              <text x={width / 2} y={height - 5} fontSize="11" fill="#475569" textAnchor="middle">ì˜¨ë„ (Â°C)</text>
              <text x={12} y={height / 2} fontSize="11" fill="#475569" textAnchor="middle" transform={`rotate(-90 12 ${height/2})`}>ìš©í•´ë„</text>

              {[0, 20, 40, 60, 80].map(t => (
                <g key={`xtick-${t}`}>
                  <line x1={getX(t)} y1={height - padding} x2={getX(t)} y2={height - padding + 4} stroke="#cbd5e1" />
                  <text x={getX(t)} y={height - padding + 14} fontSize="9" fill="#64748b" textAnchor="middle">{t}</text>
                </g>
              ))}

              {[0, 40, 80, 120].map(s => (
                <g key={`ytick-${s}`}>
                  <line x1={padding - 4} y1={getY(s)} x2={padding} y2={getY(s)} stroke="#cbd5e1" />
                  <text x={padding - 6} y={getY(s) + 3} fontSize="9" fill="#64748b" textAnchor="end">{s}</text>
                </g>
              ))}

              <path d={pathA} fill="none" stroke="#2563eb" strokeWidth="2.5" />
              <path d={pathB} fill="none" stroke="#ef4444" strokeWidth="2.5" />
              
              <circle cx={getX(temp)} cy={getY(getSolubilityA(temp))} r="3" fill="#1d4ed8" />
              <circle cx={getX(temp)} cy={getY(getSolubilityB(temp))} r="3" fill="#b91c1c" />
              <line x1={getX(temp)} y1={height - padding} x2={getX(temp)} y2={padding - 10} stroke="#94a3b8" strokeDasharray="4" strokeWidth="1" />
            </svg>
          );
        };

        return (
          <div className="p-4 md:p-8 font-sans">
            <div id="capture-area" className="max-w-6xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden mb-6 p-2">
              
              {/* Header */}
              <header className="bg-indigo-600 text-white p-6 rounded-t-xl flex items-center justify-between">
                <div>
                  <h1 className="text-2xl font-bold flex items-center gap-2">
                    <Beaker /> ê°€ìƒ ì‹¤í—˜ì‹¤: ìš©í•´ë„ ì°¨ì´ë¥¼ ì´ìš©í•œ ë¶„ë¦¬
                  </h1>
                  <p className="text-indigo-100 text-sm mt-1">ë¶„ë³„ ê²°ì •(Fractional Crystallization)ì„ í™œìš©í•˜ì—¬ ìˆœìˆ˜í•œ ë¬¼ì§ˆ ì–»ê¸°</p>
                </div>
                <button 
                  onClick={reset}
                  className="flex items-center gap-1 bg-indigo-700 hover:bg-indigo-800 px-4 py-2 rounded-lg transition-colors text-sm font-medium"
                >
                  <RefreshCw size={16} /> ì‹¤í—˜ ë‹¤ì‹œí•˜ê¸°
                </button>
              </header>

              <main className="grid grid-cols-1 lg:grid-cols-3 gap-0 lg:gap-8 p-6 pb-2">
                
                {/* Left Panel: Controls */}
                <div className="lg:col-span-1 space-y-6">
                  <div className="bg-gray-100 rounded-xl p-4">
                    <h3 className="text-sm font-bold text-gray-500 uppercase mb-3">ì‹¤í—˜ ë‹¨ê³„</h3>
                    <div className="flex justify-between items-center text-xs text-center">
                      <div className={`flex-1 ${simState === 'setup' ? 'text-indigo-600 font-bold' : 'text-gray-400'}`}>1. ì¤€ë¹„</div>
                      <div className="w-4 h-0.5 bg-gray-300"></div>
                      <div className={`flex-1 ${simState === 'heating' ? 'text-orange-500 font-bold' : 'text-gray-400'}`}>2. ê°€ì—´</div>
                      <div className="w-4 h-0.5 bg-gray-300"></div>
                      <div className={`flex-1 ${simState === 'cooling' || simState === 'challenge' ? 'text-blue-500 font-bold' : 'text-gray-400'}`}>3. ë¶„ë¦¬ ë„ì „</div>
                    </div>
                  </div>

                  <div className="bg-white border border-gray-200 rounded-xl p-5 shadow-sm space-y-6">
                    <div className="bg-gray-50 p-4 rounded-lg border border-gray-100">
                      <div className="text-gray-500 text-xs font-bold uppercase mb-2 flex items-center gap-1">
                          <Scale size={12}/> ì‹¤í—˜ ì¡°ê±´ (ì´ˆê¸° íˆ¬ì…ëŸ‰)
                      </div>
                      <div className="space-y-3">
                          <div className="flex justify-between items-center bg-white p-2 rounded border border-gray-200">
                              <span className="font-bold text-blue-600 flex items-center gap-2">
                                  <span className="w-2 h-2 rounded-full bg-blue-600"></span> ë¬¼ì§ˆ A
                              </span>
                              <span className="font-mono font-bold text-gray-700">{massA}g</span>
                          </div>
                          <div className="flex justify-between items-center bg-white p-2 rounded border border-gray-200">
                              <span className="font-bold text-red-500 flex items-center gap-2">
                                  <span className="w-2 h-2 rounded-full bg-red-500"></span> ë¬¼ì§ˆ B (ë¶ˆìˆœë¬¼)
                              </span>
                              <span className="font-mono font-bold text-gray-700">{massB}g</span>
                          </div>
                      </div>
                    </div>

                    {simState === 'setup' && (
                      <button onClick={startExperiment} className="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition shadow-lg flex justify-center items-center gap-2">
                        <Flame size={18} /> ì‹¤í—˜ ì‹œì‘ (ê°€ì—´í•˜ê¸°)
                      </button>
                    )}

                    {simState === 'heating' && (
                      <button onClick={heatUp} className="w-full bg-orange-500 text-white py-3 rounded-xl font-bold hover:bg-orange-600 transition shadow-lg flex justify-center items-center gap-2 animate-pulse">
                        <Flame size={18} /> 80Â°Cê¹Œì§€ ê°€ì—´í•˜ì—¬ ë…¹ì´ê¸°
                      </button>
                    )}

                    {(simState === 'cooling' || simState === 'challenge') && (
                      <div className="space-y-4">
                        <div className="bg-blue-50 p-4 rounded-xl border border-blue-100">
                          <label className="block text-sm font-bold text-blue-800 mb-2 flex items-center gap-2">
                            <Thermometer size={16}/> ì˜¨ë„ ì¡°ì ˆê¸°
                          </label>
                          
                          <div className="flex items-center gap-3">
                            <input 
                              type="range" min="0" max="80" step="1" value={temp} 
                              onChange={handleTempSlider}
                              className="flex-1 accent-blue-500 cursor-pointer"
                            />
                            <div className="flex items-center bg-white border border-blue-300 rounded overflow-hidden">
                              <input 
                                type="number" min="0" max="80" value={Math.round(temp)} 
                                onChange={handleTempInput}
                                className="w-12 py-1 text-center font-bold text-blue-800 focus:outline-none"
                              />
                              <span className="pr-2 text-blue-600 text-sm font-bold">Â°C</span>
                            </div>
                          </div>
                          <div className="flex justify-between text-xs text-blue-600 mt-1 font-mono">
                            <span>0Â°C</span>
                            <span>80Â°C</span>
                          </div>
                        </div>
                        
                        <div className="text-xs text-gray-600 bg-gray-100 p-3 rounded">
                          ì˜¨ë„ë¥¼ ì²œì²œíˆ ë‚®ì¶”ë©° Aê°€ ë¨¼ì € ì„ì¶œë˜ëŠ”ì§€ ê´€ì°°í•˜ì„¸ìš”.<br/>
                          <span className="text-red-500 font-bold">ì£¼ì˜:</span> ì˜¨ë„ë¥¼ ë„ˆë¬´ ë‚®ì¶”ë©´ Bë„ í•¨ê»˜ ì„ì¶œë©ë‹ˆë‹¤!
                        </div>
                      </div>
                    )}
                  </div>
                </div>

                {/* Center Panel: Visualization */}
                <div className="lg:col-span-1 flex flex-col items-center justify-start pt-4">
                  <div className="bg-gradient-to-b from-gray-50 to-white w-full rounded-2xl border border-gray-200 p-6 pb-12 min-h-[400px] flex flex-col items-center relative shadow-inner">
                      <h2 className="text-lg font-bold text-gray-700 mb-2">ì‹¤í—˜ ê´€ì°°</h2>
                      {renderBeaker()}
                      <div className="mt-12 w-full grid grid-cols-2 gap-2 text-sm z-10 relative">
                        <div className="bg-white p-2 rounded shadow-sm border border-gray-100 text-center">
                          <div className="text-gray-500 text-xs">í˜„ì¬ ì˜¨ë„</div>
                          <div className="font-digital font-bold text-xl text-gray-800">{temp.toFixed(1)}Â°C</div>
                        </div>
                        <div className="bg-white p-2 rounded shadow-sm border border-gray-100 text-center">
                          <div className="text-gray-500 text-xs">ì´ ì„ì¶œëŸ‰</div>
                          <div className={`font-bold text-xl ${totalPrecipitate > 0 ? 'text-indigo-600' : 'text-gray-400'}`}>
                            {totalPrecipitate.toFixed(1)}g
                          </div>
                        </div>
                      </div>

                      <div className="mt-4 text-center h-12 w-full flex items-center justify-center">
                        {precipitatedA > 0 && precipitatedB > 0 ? (
                          <div className="bg-purple-100 text-purple-700 px-4 py-2 rounded-lg font-bold animate-pulse text-sm border border-purple-200 shadow-sm z-10 relative">
                            <AlertCircle size={16} className="inline mr-1 mb-0.5"/>
                            ë¹„ì»¤ ë°”ë‹¥ì— <br/>ë¬¼ì§ˆAì™€ ë¬¼ì§ˆBê°€ ë™ì‹œì— ì„ì¶œë˜ì—ˆìŠµë‹ˆë‹¤!
                          </div>
                        ) : precipitatedA > 0 ? (
                          <div className="bg-blue-100 text-blue-700 px-4 py-2 rounded-lg font-bold animate-pulse border border-blue-200 shadow-sm z-10 relative">
                            ë¹„ì»¤ ë°”ë‹¥ì— ë¬¼ì§ˆAê°€ ì„ì¶œë˜ì—ˆìŠµë‹ˆë‹¤!
                          </div>
                        ) : precipitatedB > 0 ? (
                          <div className="bg-red-100 text-red-700 px-4 py-2 rounded-lg font-bold animate-pulse border border-red-200 shadow-sm z-10 relative">
                            ë¹„ì»¤ ë°”ë‹¥ì— ë¬¼ì§ˆBê°€ ì„ì¶œë˜ì—ˆìŠµë‹ˆë‹¤!
                          </div>
                        ) : (
                          <div className="text-gray-400 text-sm z-10 relative">í˜„ì¬ ëª¨ë“  ë¬¼ì§ˆì´ ë…¹ì•„ìˆìŠµë‹ˆë‹¤.</div>
                        )}
                      </div>
                  </div>
                </div>

                {/* Right Panel: Challenge */}
                <div className="lg:col-span-1 space-y-4">
                  {(simState === 'cooling' || simState === 'challenge') && (
                    <div className="bg-yellow-50 rounded-xl p-5 border border-yellow-100 shadow-sm">
                      <h3 className="font-bold text-yellow-800 mb-3 flex items-center gap-2">
                        <Trophy size={18} /> ë¯¸ì…˜: ìˆœìˆ˜ ë¶„ë¦¬í•˜ê¸°
                      </h3>
                      <p className="text-sm text-yellow-900 mb-4 leading-relaxed">
                        ë¶ˆìˆœë¬¼(B)ì€ ê³„ì† ë…¹ì•„ìˆê³ , <br/>
                        ìˆœìˆ˜í•œ <strong>ë¬¼ì§ˆ Aë§Œ ê°€ì¥ ë§ì´</strong> ì–»ì„ ìˆ˜ ìˆëŠ” <br/>
                        ìµœì ì˜ ì˜¨ë„ë¥¼ ì°¾ì•„ ê²°ì •ì„ ë¶„ë¦¬í•´ë³´ì„¸ìš”!
                      </p>
                      
                      <div className="flex flex-col gap-3">
                        <button 
                          onClick={checkOptimalTemp}
                          className="w-full bg-yellow-400 text-yellow-900 py-3 rounded-lg font-bold hover:bg-yellow-500 transition shadow-sm flex justify-center items-center gap-2"
                        >
                          ì´ ì˜¨ë„ì—ì„œ ë¶„ë¦¬ ì§„í–‰í•˜ê¸°
                        </button>
                        
                        {challengeMessage && (
                          <div className={`p-3 rounded-lg text-sm flex items-start gap-2 border ${
                            challengeMessage.type === 'success' ? 'bg-green-100 text-green-800 border-green-200' :
                            challengeMessage.type === 'fail' ? 'bg-red-100 text-red-800 border-red-200' :
                            'bg-orange-100 text-orange-800 border-orange-200'
                          }`}>
                            {challengeMessage.type === 'success' ? <CheckCircle className="shrink-0 mt-0.5" size={16}/> : 
                              <AlertCircle className="shrink-0 mt-0.5" size={16}/>}
                            <span className="font-medium whitespace-pre-line">{challengeMessage.text}</span>
                          </div>
                        )}
                      </div>
                    </div>
                  )}

                  <div className="bg-white p-5 rounded-xl border border-gray-200 shadow-sm text-sm text-gray-700">
                    <strong className="block mb-2 text-lg border-b pb-2">ğŸ’¡ ì‹¤í—˜ ëª©í‘œ</strong>
                    <ul className="list-disc pl-4 space-y-2">
                      <li>ì˜¨ë„ë¥¼ ì„œì„œíˆ ë‚®ì¶”ë©° <strong>ì–´ë–¤ ë¬¼ì§ˆì˜ ê²°ì •ì´ ë¨¼ì € ìƒì„±ë˜ëŠ”ì§€</strong> ê´€ì°°í•©ë‹ˆë‹¤.</li>
                      <li>ì˜¨ë„ë¥¼ ë„ˆë¬´ ê³¼ë„í•˜ê²Œ ë‚®ì¶”ë©´ ìš©í•´ë„ê°€ ë–¨ì–´ì§„ <strong>ë¬¼ì§ˆ Bë„ í•¨ê»˜ ì„ì¶œ</strong>ë˜ë¯€ë¡œ ì£¼ì˜í•©ë‹ˆë‹¤.</li>
                      <li>Bê°€ ì„ì¶œë˜ê¸° ì§ì „ì˜ ìµœì  ì˜¨ë„ë¥¼ ì°¾ì•„ <strong>ìˆœìˆ˜í•œ Aë¥¼ ìµœëŒ€ë¡œ</strong> ë¶„ë¦¬í•´ëƒ…ë‹ˆë‹¤.</li>
                    </ul>
                  </div>
                </div>

                {/* ë¶„ë¦¬ ì„±ê³µ ì‹œ í‘œì‹œë˜ëŠ” ë¶„ì„ ë° ë³´ê³ ì„œ ì˜ì—­ (Full Width) */}
                {challengeMessage?.type === 'success' && (
                  <div className="lg:col-span-3 mt-4 mb-4 bg-green-50 border-2 border-green-200 rounded-xl p-6 shadow-md">
                    <h2 className="text-xl font-bold text-green-800 mb-6 flex items-center gap-2">
                        <CheckCircle className="text-green-600" /> ì‹¤í—˜ ì„±ê³µ! ê²°ê³¼ ë°ì´í„° ë° ë³´ê³ ì„œ ì‘ì„±
                    </h2>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                      {/* ì¢Œì¸¡: ê·¸ë˜í”„ì™€ í‘œ */}
                      <div className="bg-white p-4 rounded-xl border border-gray-200">
                        <h3 className="font-bold text-gray-700 mb-4 border-b pb-2">ğŸ“Š ì˜¨ë„ì— ë”°ë¥¸ ìš©í•´ë„ ë°ì´í„° ë¶„ì„</h3>
                        
                        <div className="flex flex-col items-center mb-6">
                          {renderGraph()}
                          <div className="flex gap-4 mt-3 text-sm">
                            <span className="flex items-center gap-1 font-bold text-blue-600"><span className="w-3 h-1 bg-blue-600 inline-block"></span> ë¬¼ì§ˆ A (ìš©í•´ë„ ì°¨ì´ í¼)</span>
                            <span className="flex items-center gap-1 font-bold text-red-500"><span className="w-3 h-1 bg-red-500 inline-block"></span> ë¬¼ì§ˆ B (ìš©í•´ë„ ì°¨ì´ ì‘ìŒ)</span>
                          </div>
                        </div>

                        <table className="w-full text-sm text-center border-collapse border border-gray-200">
                          <thead>
                            <tr className="bg-gray-100">
                                <th className="border border-gray-200 p-2 text-gray-700">ì˜¨ë„(Â°C)</th>
                                <th className="border border-gray-200 p-2 text-blue-600">ë¬¼ì§ˆ A ìš©í•´ë„</th>
                                <th className="border border-gray-200 p-2 text-red-500">ë¬¼ì§ˆ B ìš©í•´ë„</th>
                            </tr>
                          </thead>
                          <tbody>
                            {[0, 20, 40, 60, 80].map(t => (
                              <tr key={t} className="hover:bg-gray-50">
                                <td className="border border-gray-200 p-2 font-mono">{t}</td>
                                <td className="border border-gray-200 p-2 font-mono">{getSolubilityA(t)}</td>
                                <td className="border border-gray-200 p-2 font-mono">{getSolubilityB(t)}</td>
                              </tr>
                            ))}
                          </tbody>
                        </table>
                        <p className="text-[10px] text-gray-400 mt-1 text-right">* ë‹¨ìœ„: g/ë¬¼ 100g</p>
                      </div>

                      {/* ìš°ì¸¡: ì„œìˆ í˜• ì‘ì„± ë° ìº¡ì²˜ */}
                      <div className="flex flex-col bg-white p-4 rounded-xl border border-gray-200">
                        <h3 className="font-bold text-gray-700 mb-2 border-b pb-2">ğŸ“ ë¶„ë¦¬ ì›ë¦¬ ì„œìˆ í•˜ê¸° (ë¶„ë³„ ê²°ì •)</h3>
                        <p className="text-sm text-gray-600 mb-3 leading-relaxed">
                          ìœ„ ê·¸ë˜í”„ì™€ í‘œë¥¼ ì°¸ê³ í•˜ì—¬, <strong>ì˜¨ë„ì— ë”°ë¥¸ ìš©í•´ë„ ì°¨ì´ê°€ í° ë‘ ë¬¼ì§ˆì„ ì–´ë–»ê²Œ ë¶„ë¦¬í•  ìˆ˜ ìˆëŠ”ì§€</strong> ê·¸ ì›ë¦¬ë¥¼ ìì„¸íˆ ì‘ì„±í•´ë³´ì„¸ìš”.
                        </p>
                        
                        <textarea
                          className="flex-1 w-full border border-gray-300 rounded-lg p-4 text-sm focus:ring-2 focus:ring-green-500 outline-none resize-none leading-relaxed text-gray-700 bg-gray-50"
                          placeholder="ì‘ì„± ì˜ˆì‹œ: ì˜¨ë„ì— ë”°ë¥¸ ìš©í•´ë„ ë³€í™”ê°€ í° ë¬¼ì§ˆ Aì™€ ë³€í™”ê°€ ì‘ì€ ë¬¼ì§ˆ Bê°€ ì„ì—¬ ìˆì„ ë•Œ, ê³ ì˜¨ì˜ ìš©ë§¤ì— ë‘ ë¬¼ì§ˆì„ ëª¨ë‘ ë…¹ì¸ í›„ í˜¼í•© ìš©ì•¡ì„ ì„œì„œíˆ ëƒ‰ê°ì‹œí‚µë‹ˆë‹¤. ê·¸ëŸ¬ë©´ ìš©í•´ë„ê°€ ê¸‰ê²©íˆ ê°ì†Œí•˜ëŠ” ë¬¼ì§ˆ Aê°€ ë¨¼ì € ê²°ì •ìœ¼ë¡œ ì„ì¶œë˜ë©°..."
                          value={essayText}
                          onChange={(e) => setEssayText(e.target.value)}
                        ></textarea>

                        <button 
                          onClick={handleCapture}
                          className="mt-4 w-full bg-slate-800 text-white py-3 rounded-lg font-bold hover:bg-slate-900 transition flex justify-center items-center gap-2 shadow-md"
                        >
                          <Camera size={18} /> ë³´ê³ ì„œ ë° ê²°ê³¼ í™”ë©´ ìº¡ì²˜í•˜ê¸°
                        </button>
                      </div>
                    </div>
                  </div>
                )}
              </main>
            </div>
            {/* ìº¡ì²˜ ì˜ì—­ ë */}

            {/* ì €ì‘ê¶Œ ë° ì—°ë½ì²˜ Footer */}
            <footer className="text-center text-gray-400 text-sm mt-8 pb-4">
              <p>&copy; 2026 ê³¼í•™ì²´ìœ¡ê´€. All rights reserved.</p>
              <p className="text-xs mt-1">ì´ ê°€ìƒ ì‹¤í—˜ì‹¤ ì½˜í…ì¸ ì˜ ë¬´ë‹¨ ë³µì œ ë° ë°°í¬ë¥¼ ê¸ˆí•©ë‹ˆë‹¤.</p>
              <p className="text-xs mt-1">ë¬¸ì˜: chuseonjae@outlook.kr | ì¸ìŠ¤íƒ€: @sweat_on_science, @songsamscience</p>
            </footer>
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>
